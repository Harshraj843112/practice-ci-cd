# HTTP server (optimized for lightweight usage)
server {
    listen 80;
    server_name localhost 3.95.156.64; # Temporary until DuckDNS is set up

    root /usr/share/nginx/html;
    index index.html;

    # Support React SPA routing
    location / {
        try_files $uri /index.html;
    }

    # Optimize for low resource usage
    client_max_body_size 1m; # Limit upload size to conserve memory
    keepalive_timeout 15;    # Reduce idle connections to free resources
}

# HTTPS server (disabled until certificates are mounted)
server {
    listen 443 ssl default_server;
    server_name myreactapp.duckdns.org;

    # SSL certificate paths (wonâ€™t activate until files are present)
    ssl_certificate /etc/nginx/certs/fullchain.pem;
    ssl_certificate_key /etc/nginx/certs/privkey.pem;

    root /usr/share/nginx/html;
    index index.html;

    # Support React SPA routing
    location / {
        try_files $uri /index.html;
    }

    # Optimize for low resource usage (when enabled)
    client_max_body_size 1m;
    keepalive_timeout 15;
}
